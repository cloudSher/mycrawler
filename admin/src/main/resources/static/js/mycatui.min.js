(function(e){var s=e(window);var i=e(document);var v=e("html");var u=e("body");var b={topHash:"",menuHash:"",defaultHash:"",logoutUrl:"",lang:"zh-cn",json:{flag:"flag",msg:"msg",data:"data",breadcrumbs:"breadcrumbs",pagination:"pageInfo",pageInfo:{totalCount:"totalCount",pageIndex:"pageIndex",pageCount:"pageCount",showCount:3},tempData:"tempData",query:"query",lang:"lang"},dateFormat:"YYYY-MM-DD",dateFormatLang:"YYYY-MM-DD HH:mm:ss",notifyOption:{placement:{from:"bottom",align:"right"},delay:3000,animate:{enter:"animated fadeInRight",exit:"animated fadeOutRight"}},hash:{tpl:"tpl",target:"target"},NProgressParent:"#main",$header:e("#header"),$leftSidebar:e("#sidebar"),$rightSidebar:e("#chat"),$content:e("#content"),$modal:e("#divModal")};var n;var C;var y={findAttr:function(F,E){var D=this.findSelector(F);return D.attr(E)||D.data(E)},findEvent:function(D){if(typeof D==="string"){return window[D]}else{return D}},findSelector:function(D){if(typeof D==="string"){return e("#"+D)}return D},scrollbar:function(E,F,D){E.niceScroll({cursorcolor:F,cursorborder:0,cursorborderradius:0,cursorwidth:D,bouncescroll:true,mousescrollstep:100})},json2excel:function(G){var J=G.sheet||"Sheet1";var F,E;var I="<table>";if(G.title){I+="<tr>";for(F=0;F<G.title.length;F++){I+="<td>"+G.title[F]+"</td>"}I+="</tr>"}if(G.list){for(F=0;F<G.list.length;F++){I+="<tr>";for(E=0;E<G.list[F].length;E++){I+="<td>"+G.list[F][E]+"</td>"}I+="</tr>"}}I+="</table>";var D="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:excel' xmlns='http://www.w3.org/TR/REC-html40'>";D+="<head>";D+="<!--[if gte mso 9]>";D+="<xml>";D+="<x:ExcelWorkbook>";D+="<x:ExcelWorksheets>";D+="<x:ExcelWorksheet>";D+="<x:Name>";D+=J;D+="</x:Name>";D+="<x:WorksheetOptions>";D+="<x:DisplayGridlines/>";D+="</x:WorksheetOptions>";D+="</x:ExcelWorksheet>";D+="</x:ExcelWorksheets>";D+="</x:ExcelWorkbook>";D+="</xml>";D+="<![endif]-->";D+="</head>";D+="<body>";D+=I;D+="</body>";D+="</html>";var H="base64,"+e.base64.encode(D);window.open("data:application/vnd.ms-excel;filename=exportData.doc;"+H)}};var g={info:function(E,D){swal({title:E,text:D,type:"info",confirmButtonText:C.btn.close})},success:function(E,D){swal({title:E,text:D,type:"success",confirmButtonText:C.btn.close})},error:function(E,D){swal({title:E,text:D,type:"error",confirmButtonText:C.btn.close})},confirm:function(E,D){swal({title:E,type:"warning",showCancelButton:true,cancelButtonText:C.btn.cancel,confirmButtonText:C.btn.ok},function(){if(D){y.findEvent(D)()}})}};var k={info:function(D){A(D,"info")},success:function(D){A(D,"success")},warning:function(D){A(D,"warning")},error:function(D){A(D,"danger")}};function A(E,D){var F=e.extend(true,{type:D},n.notifyOption);e.growl({message:E},F)}var o={getJSON:function(D,G,E,F){c("get",D,G,E,F)},postJSON:function(D,G,E,F){c("post",D,G,E,F)}};function c(G,E,I,F,H,D){H=H!==false;e.ajax({type:G,url:E,cache:false,data:I,success:function(J){if(J[n.json.flag]){if(F){y.findEvent(F)(J[n.json.data])}else{if(G==="post"){k.success(C.msg.success);f.reload();w.hide()}}}else{k.error(J.msg);if(D){D()}}},dataType:"json",global:H})}var f={loadStatic:function(F,D,E){h(F,D,E)},load:function(D){m(n.$content,D);d(D)},reload:function(){this.load(window.location.hash)},loadPart:function(E,D){m(E,D,false)}};function d(E){n.$leftSidebar.find("a.active").removeClass("active");n.$leftSidebar.find("div.toggled,li.toggled").removeClass("active toggled");n.$leftSidebar.find("div.profile-menu>ul.main-menu").hide();n.$leftSidebar.find("li.sub-menu>ul").hide();E=q(E);var D=E.target;if(D){n.$leftSidebar.find('a[data-target="'+D+'"]').each(function(){var G=e(this);var H=G.parents("li.sub-menu");if(H.length){H.addClass("active toggled");H.find(">ul").show();G.addClass("active")}else{G.parent().addClass("active");var F=G.parents("div.profile-menu");if(F.length){F.addClass("toggled");F.find("ul.main-menu").show()}}})}else{n.$leftSidebar.find("div.sidebar-inner>ul.main-menu>li:first").addClass("active")}}function m(G,F,E,D){if(!F||F==="#"){F=n.defaultHash}F=q(F);o.getJSON(F.url,F.data,function(J){J[n.json.query]=F.data;J[n.json.lang]=C;var I=J[n.json.breadcrumbs];if(typeof I==="string"){J[n.json.breadcrumbs]=[{title:I}]}var H=J[n.json.pagination];if(H){J.pagination=a(H)}var K=J[n.json.tempData];if(K){window[n.json.tempData]=K;delete J[n.json.tempData]}h(G,F.tpl,J);t(G);r(G);D&&D()},E)}function a(I){var P=I[n.json.pageInfo.totalCount];if(!P){return""}var E=n.json.pageInfo.showCount||3;var F=I[n.json.pageInfo.pageCount]||8;var G=I[n.json.pageInfo.pageIndex]||0;var K=Math.ceil(P/F);var M=G+1;if(M<1){M=1}if(M>K){M=K}var O=M-E;if(O<1){O=1}var L=M+E;if(L>K){L=K}var D='<li><a><i class="zmdi zmdi-more-horiz"></i></a></li>';var J='<div class="bootgrid-footer container-fluid"><div class="row"><div class="col-sm-12 m-b-25"><ul class="pagination">';J+="<li";if(M===1){J+=' class="disabled"'}J+="><a";if(M!==1){J+=' href="'+N(M-2,F)+'"'}J+=' aria-label="'+C.btn.prev+'"><i class="zmdi zmdi-chevron-left"></i></a></li>';if(O>1){J+=D}for(var H=O;H<=L;H++){J+="<li";if(H===M){J+=' class="active"'}J+='><a href="'+N(H-1,F)+'">'+H;if(H===M){J+=' <span class="sr-only">(current)</span>'}J+="</a></li>"}if(L<K){J+=D}J+="<li";if(M===K){J+=' class="disabled"'}J+="><a";if(M!==K){J+=' href="'+N(M,F)+'"'}J+=' aria-label="'+C.btn.next+'"><i class="zmdi zmdi-chevron-right"></i></a></li>';J+="</ul></div></div></div>";return J;function N(R,T){var S=n.json.pageInfo.pageIndex;var Q=n.json.pageInfo.pageCount;return"#"+URI(window.location.hash.substring(1)).setSearch(S,R).setSearch(Q,T)}}function t(F){var D=y.findSelector(F);Waves.attach(".btn:not(.btn-icon):not(.btn-float)");Waves.attach(".btn-icon, .btn-float",["waves-circle","waves-float"]);Waves.init();D.find(".lightbox").lightGallery({enableTouch:true});D.find(".html-editor").summernote({height:200,lang:n.lang});D.find(".fg-float .form-control").each(function(){var G=e(this).val();if(!G.length==0){e(this).closest(".fg-line").addClass("fg-toggled")}});if(!v.hasClass("ismobile")){var E=D.find(".table-responsive");E[0]&&y.scrollbar(E,"rgba(0,0,0,0.5)","5px");E=D.find(".chosen-results");E[0]&&y.scrollbar(E,"rgba(0,0,0,0.5)","5px");E=D.find(".tab-nav");E[0]&&y.scrollbar(E,"rgba(0,0,0,0)","1px");E=D.find(".c-overflow");E[0]&&y.scrollbar(E,"rgba(0,0,0,0.5)","5px")}}function r(E){var D=y.findSelector(E);D.find(".form-validate").validationEngine({scroll:true});D.find(".tbl-tree").each(function(){var G=e(this);var F=parseInt(G.data("lvl"));z.tree(G,F)});D.find(".tbl-dyna-tree").each(function(){var H=e(this);var G=H.data("url");var F=H.data("tpl");z.dynaTree(H,G,F)});D.find(".select-picker").each(function(){var G=e(this);var F=G.data("value");G.selectpicker();F&&G.selectpicker("val",F)});D.find(".date-picker").datetimepicker({format:n.dateFormat});D.find(".date-time-picker").datetimepicker({format:n.dateFormatLang,showClose:true});D.find(".daterange-picker").daterangepicker({autoApply:true,locale:{format:n.dateFormat}});D.find(".auto-complete,.auto-select").each(function(){var I=e(this);var G=I.data("url");if(!G){return}var H={ajax:{url:G,triggerLength:1,scrollBar:true}};if(I.hasClass("auto-select")){var F=I.attr("name");I.removeAttr("name");var J=I.data("text")||"";I.after(e('<input type="hidden" class="selected-text" value="'+J+'" name="'+F+'Text">'));I.after(e('<input type="hidden" class="selected-value" value="'+I.val()+'" name="'+F+'">'));I.val(J);H.onSelect=function(L){I.nextAll(".selected-text").val(L.text);I.nextAll(".selected-value").val(L.value);var K=I.data("fn");if(K){window[K](L)}};I.blur(function(){var L=I.val();var K=I.nextAll(".selected-text").val();if(!L){I.nextAll(".selected-text").val("");I.nextAll(".selected-value").val("")}else{if(L!==K){I.val(K)}}})}I.typeahead(H)});D.find(".upload-xsl input").each(function(){e(this).fileupload({url:e(this).data("url"),dataType:"json",acceptFileTypes:/(\.|\/)(xls|xlsx)$/i,maxFileSize:2*1024*1024,messages:{acceptFileTypes:"只能上传EXCEL文件",maxFileSize:"文件大小不能超过2M"}}).on("fileuploadprocessalways",function(H,G){var F=G.files[G.index];if(F.error){var I=F.name+" : "+F.error;k.error(I)}}).on("fileuploaddone",function(G,F){if(F.result.flag){k.success("上传成功");f.reload()}else{k.error(F.result.msg)}}).on("fileuploadfail",function(G,F){k.error("文件无法上传到服务器")}).prop("disabled",!e.support.fileInput).parent().addClass(e.support.fileInput?undefined:"disabled")})}function q(I){if(I.substr(0,1)==="#"){I=I.substring(1)}var F=URI(I);var E=F.path();var G=F.query(true);var D=G[n.hash.tpl]||E;var H=G[n.hash.target]||D;delete G[n.hash.tpl];delete G[n.hash.target];return{url:E,tpl:D,data:G,target:H}}function h(H,D,F){var G=y.findSelector(H);var E=template(D,F);G.html(E)}var z={tree:function(E,D){l(E,D)},dynaTree:function(F,E,D){l(F,false,E,D)},hasChild:function(D,E){return !!e("."+E,y.findSelector(D)).length},getCheckedValue:function(D){return y.findSelector(D).find(".chk-line:checked").serialize()}};function l(J,F,E,D){var H=y.findSelector(J);var I=F||1;var G={expandLevel:I};if(E&&D){G.beforeExpand=function(K,L){if(z.hasChild(K,L)){return}c("get",E.replace("#id#",L),null,function(N){if(N.list){N.pid=L;var M=template(D,N);K.addChilds(M)}else{e("#"+L+' span[arrow="true"]').attr("class","vsStyle_node vsStyle_last_leaf")}},true,function(){e("#"+L+' span[arrow="true"]').attr("class","vsStyle_active_node vsStyle_last_shut")})}}H.treeTable(G)}var w={show:function(E,D){m(n.$modal.find(".modal-content"),E,true,function(){var F=n.$modal.children();F.removeClass("modal-lg modal-sm");if(D==="modal-lg"||D==="modal-sm"){F.addClass(D)}n.$modal.modal("show")})},hide:function(){n.$modal.modal("hide")}};var p={sparklineBar:function(I,F,D,G,E,H){y.findSelector(I).sparkline(F,{type:"bar",height:D,barWidth:G,barColor:E,barSpacing:H})},sparklineLine:function(F,O,H,P,N,G,L,E,D,M,J,I,K){y.findSelector(F).sparkline(O,{type:"line",width:H,height:P,lineColor:N,fillColor:G,lineWidth:L,maxSpotColor:E,minSpotColor:D,spotColor:M,spotRadius:J,highlightSpotColor:I,highlightLineColor:K})},sparklinePie:function(H,E,F,D,G){y.findSelector(H).sparkline(E,{type:"pie",width:F,height:D,sliceColors:G,offset:0,borderWidth:0})},easyPieChart:function(J,H,G,E,D,I,F){y.findSelector(J).easyPieChart({trackColor:H,scaleColor:G,barColor:E,lineWidth:D,lineCap:I,size:F})}};var B={createByOp:function(E,F,D){E="echarts/chart/"+E;require(["echarts",E],function(G){var H=G.init(document.getElementById(F));H.setOption(D)})},createByOpName:function(D,G,E){var F=window[n.json.tempData][E];delete window[n.json.tempData][E];this.createByOp(D,G,F)}};window.mycatui={langs:[],init:function(D){n=e.extend(true,{},b,D);C=this.langs[n.lang];moment.locale("zh_cn");NProgress.configure({parent:n.NProgressParent});if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){v.addClass("ismobile")}else{y.scrollbar(v,"rgba(0,0,0,0.3)","5px")}f.loadPart(n.$header,n.topHash);m(n.$leftSidebar,n.menuHash,false,function(){j()})},msg:g,notify:k,ajax:o,page:f,table:z,chart:p,echart:B};function j(){f.load(window.location.hash);(function(){s.on("hashchange",function(){f.load(window.location.hash)});i.ajaxSend(function(){NProgress.start()}).ajaxComplete(function(){NProgress.done()}).ajaxError(function(G,F,E){var D={};D.status=F.status;D.url=E.url;switch(D.status){case 401:g.confirm(C.msg.e401,function(){window.location.href=n.logoutUrl});break;case 403:k.error(C.msg.e403);break;case 404:D.msg=C.msg.e404;f.loadStatic(n.$content,"public/error",D);break;case 408:k.error(C.msg.e408);break;case 500:D.msg=C.msg.e500;f.loadStatic(n.$content,"public/error",D);break;default:console.log(D)}})})();(function(){u.on("click","#top-search > a",function(E){E.preventDefault();e("#header").addClass("search-toggled");e("#top-search-wrap").find("input").focus()});u.on("click","#top-search-close",function(E){E.preventDefault();e("#header").removeClass("search-toggled")});var D=localStorage.getItem("ma-layout-status");if(D==1){u.addClass("sw-toggled");e("#tw-switch").prop("checked",true)}u.on("change","#toggle-width input:checkbox",function(){if(e(this).is(":checked")){setTimeout(function(){u.addClass("toggled sw-toggled");localStorage.setItem("ma-layout-status",1)},250)}else{setTimeout(function(){u.removeClass("toggled sw-toggled");localStorage.setItem("ma-layout-status",0);e(".main-menu > li").removeClass("animated")},250)}});u.on("click",'a[data-action="fullscreen"]',function(F){F.preventDefault();G(document.documentElement);e(this).closest(".dropdown").removeClass("open");function G(H){if(H.requestFullscreen){H.requestFullscreen()}else{if(H.mozRequestFullScreen){H.mozRequestFullScreen()}else{if(H.webkitRequestFullscreen){H.webkitRequestFullscreen()}else{if(H.msRequestFullscreen){H.msRequestFullscreen()}}}}}function E(){if(document.exitFullscreen){document.exitFullscreen()}else{if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else{if(document.webkitExitFullscreen){document.webkitExitFullscreen()}}}}});u.on("click",'a[data-action="clear-localstorage"]',function(E){E.preventDefault();mycatui.msg.confirm(C.msg.clearLocalstorageConfirm,function(){localStorage.clear();mycatui.notify.success(C.msg.clearLocalstorageSuccess)})});u.on("click","#menu-trigger, #chat-trigger",function(G){G.preventDefault();var E=e(this).data("trigger");e(E).toggleClass("toggled");e(this).toggleClass("open");u.toggleClass("modal-open");e(".sub-menu.toggled").not(".active").each(function(){e(this).removeClass("toggled");e(this).find("ul").hide()});e(".profile-menu .main-menu").hide();var F;var H;if(E=="#sidebar"){F="#sidebar";H="#menu-trigger";e("#chat-trigger").removeClass("open");if(!n.$rightSidebar.hasClass("toggled")){n.$header.toggleClass("sidebar-toggled")}else{n.$rightSidebar.removeClass("toggled")}}else{if(E=="#chat"){F="#chat";H="#chat-trigger";e("#menu-trigger").removeClass("open");if(!n.$leftSidebar.hasClass("toggled")){n.$header.toggleClass("sidebar-toggled")}else{n.$leftSidebar.removeClass("toggled")}}}if(n.$header.hasClass("sidebar-toggled")){i.on("click",function(I){if((e(I.target).closest(F).length===0)&&(e(I.target).closest(H).length===0)){setTimeout(function(){u.removeClass("modal-open");e(F).removeClass("toggled");n.$header.removeClass("sidebar-toggled");e(H).removeClass("open")})}})}})})();(function(){u.on("click","div.profile-menu>a,li.sub-menu>a",function(E){E.preventDefault();var D=e(this);D.next().slideToggle(200);D.parent().toggleClass("toggled")});u.on("click",'a[data-action="logout"]',function(D){D.preventDefault();mycatui.msg.confirm(C.msg.logoutConfirm,function(){window.location.href=n.logoutUrl})})})();(function(){u.on("click",".btn-nav",function(){var D=e(this).attr("href");if(D===window.location.hash){f.load(D)}});u.on("click",".btn-search",function(F){F.preventDefault();var D=e(this).parents("form");var E=D.attr("action");E+=(E.indexOf("?")===-1?"?":"&");E+=D.serialize();window.location.hash=E});u.on("click",".btn-del",function(F){F.preventDefault();var E=e(this);var G=E.data("id");var D=E.parents("tbody");if(D.hasClass("tree_table")&&z.hasChild(D,G)){k.error(C.msg.notDeleteTreeHasChild);return}g.confirm(C.msg.deleteConfirm,function(){var H=E.data("url");var I={id:G};o.postJSON(H,I)})});u.on("click",".btn-save",function(G){G.preventDefault();var F=e(this);var D=F.data("fnPre");if(D){if(window[D]()===false){return}}var E=F.parents("form");if(E.validationEngine("validate")){o.postJSON(E.prop("action"),E.serialize(),F.data("fn"))}});u.on("click",".btn-modal",function(G){G.preventDefault();var F=e(this);var E=y.findAttr(F,"href");var D=F.data("size");w.show(E,D)});u.on("click","table input.chk-all",function(){e(this).parents("table").find("tbody input.chk-line").prop("checked",this.checked)});u.on("click","table input.chk-line",function(){var H=e(this);var E=H.parents("tbody");if(E.hasClass("tree_table")){var J=this.value;if(this.checked&&E.hasClass("tree-single")){F(J)}else{I(J,this.checked)}if(this.checked){G(J)}function G(L){var K=e("#"+L).attr("pid");if(K){e("#"+K).find(".chk-line").prop("checked",true);if(E.hasClass("tree-single")){F(K)}G(K)}}function F(M){var L=e("#"+M);var K=L.attr("pid");L.siblings('[pid="'+K+'"]').find(".chk-line").each(function(){this.checked=false;I(this.value,false)})}function I(L,K){E.find("."+L).each(function(){e(this).find(".chk-line").prop("checked",K);I(this.id,K)})}}else{var D=true;E.find(".chk-line").each(function(){if(!this.checked){D=false;return false}});E.parent().find(".chk-all").prop("checked",D)}});u.on("click",".btn-export",function(G){G.preventDefault();var F=e(this);var D=F.data("url");var H=F.data("formId");var E={};if(H){E=e("#"+H).serialize()}o.getJSON(D,E,function(I){y.json2excel(I)})});u.on("click",".upload-xsl",function(D){D.preventDefault();e(this).find("input").click()}).on("click",".upload-xsl input",function(D){D.stopPropagation()});u.on("click",".lvh-search-trigger",function(D){D.preventDefault();x=e(this).closest(".lv-header-alt").find(".lvh-search");x.fadeIn(300);x.find(".lvhs-input").focus()});u.on("click",".lvh-search-close",function(){x.fadeOut(300);setTimeout(function(){x.find(".lvhs-input").val("")},350)});u.on("focus",".form-control",function(){e(this).closest(".fg-line").addClass("fg-toggled")});u.on("blur",".form-control",function(){var E=e(this).closest(".form-group");var D=E.find(".form-control").val();if(E.hasClass("fg-float")){if(D.length==0){e(this).closest(".fg-line").removeClass("fg-toggled")}}else{e(this).closest(".fg-line").removeClass("fg-toggled")}})})()}})(window.jQuery);
